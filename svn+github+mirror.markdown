# Creating autmoatic svn to github mirror #

I was interested in mirroring an Open Source project from a SVN repository to a Github repository.

Of course someone else already did [this](http://www.fnokd.com/2008/08/20/mirroring-svn-repository-to-github/). I do a slight variation as I'm using a Linode slice for the mirror.

I use Osmosis as an example. I only wanted the mirror the trunk from the [SVN Repository](http://svn.openstreetmap.org/applications/utils/osmosis/trunk/). 

## Local ##

	mkdir osmosis
	cd osmosis
	git svn init http://svn.openstreetmap.org/applications/utils/osmosis/trunk
	git svn fetch
	git gc
	hub create
	# repo needs a proper master
	git push origin master
	# create copy of master
	git checkout -b vendor
	git push origin vendor
	
Preparing it for git flow

	git checkout -b develop
	git flow init
	# just confirm the defaults
	git push origin develop

I then build the project, and added a `.gitignore` file to ignore the autogenerated files.

Prepare feature

	git flow feature start ignore
	
Finish the feature

	git flow feature finish ignore
	git push origin develop
	
## Push repository to remote server ##

Time to make the auto-merging happen. First we copy the created git repo to the remote server.

	cd ..
	tar -pczf osmosis.tar.gz osmosis
	scp osmosis.tar.gz user@linode
	
I created a SSH alias for my Linode slice

	ssh user@linode
	tar xvfz osmosis.tar.gz
	
Create a ssh key for github (don't use a passphrase)

	ssh keygen
	
Copy the key to your [Github Account settings](https://github.com/account).

## Create mirroring script ## ##

	touch svn2github
	vi svn2github
	
	#!/bin/sh
	cd /home/user/github-svn-mirrors/$1
	git svn rebase
	git push origin vendor

	chmod u+x svn2github
	
Try it out for the first time. It should ask you to add `github.com` to the list of known hosts.

## Create cron job ##

	crontab -e
	*/15 * * * * /home/user/scripts/svn2github osmosis
	